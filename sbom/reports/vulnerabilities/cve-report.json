{
  "npm": {
    "actions": [
      {
        "action": "review",
        "module": "micromatch",
        "resolves": [
          {
            "id": 1098681,
            "path": ".>eslint-plugin-boundaries>micromatch",
            "dev": false,
            "optional": false,
            "bundled": false
          }
        ]
      },
      {
        "action": "review",
        "module": "esbuild",
        "resolves": [
          {
            "id": 1102341,
            "path": ".>vitest>vite>esbuild",
            "dev": false,
            "optional": false,
            "bundled": false
          },
          {
            "id": 1102341,
            "path": "apps__cortex-webui>vitest>vite>esbuild",
            "dev": false,
            "optional": false,
            "bundled": false
          }
        ]
      },
      {
        "action": "review",
        "module": "cookie",
        "resolves": [
          {
            "id": 1103907,
            "path": "packages__prp-runner>lighthouse>@sentry/node>cookie",
            "dev": false,
            "optional": false,
            "bundled": false
          }
        ]
      },
      {
        "action": "review",
        "module": "cross-spawn",
        "resolves": [
          {
            "id": 1104664,
            "path": "packages__gateway>@pact-foundation/pact>@pact-foundation/pact-core>cross-spawn",
            "dev": false,
            "optional": false,
            "bundled": false
          }
        ]
      },
      {
        "action": "review",
        "module": "tmp",
        "resolves": [
          {
            "id": 1106849,
            "path": ".>inquirer>external-editor>tmp",
            "dev": false,
            "optional": false,
            "bundled": false
          }
        ]
      }
    ],
    "advisories": {
      "1098681": {
        "findings": [
          {
            "version": "4.0.7",
            "paths": [
              ". > eslint-plugin-boundaries@4.2.2 > micromatch@4.0.7"
            ]
          }
        ],
        "found_by": null,
        "deleted": null,
        "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-4067\n- https://github.com/micromatch/micromatch/issues/243\n- https://github.com/micromatch/micromatch/pull/247\n- https://devhub.checkmarx.com/cve-details/CVE-2024-4067\n- https://github.com/micromatch/micromatch/blob/2c56a8604b68c1099e7bc0f807ce0865a339747a/index.js#L448\n- https://github.com/micromatch/micromatch/commit/500d5d6f42f0e8dfa1cb5464c6cb420b1b6aaaa0\n- https://github.com/micromatch/micromatch/pull/266\n- https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade\n- https://advisory.checkmarx.net/advisory/CVE-2024-4067\n- https://github.com/micromatch/micromatch/releases/tag/4.0.8\n- https://github.com/advisories/GHSA-952p-6rrq-rcjv",
        "created": "2024-05-14T18:30:54.000Z",
        "id": 1098681,
        "npm_advisory_id": null,
        "overview": "The NPM package `micromatch` prior to version 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in `micromatch.braces()` in `index.js` because the pattern `.*` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persisted prior to https://github.com/micromatch/micromatch/pull/266. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching.\n",
        "reported_by": null,
        "title": "Regular Expression Denial of Service (ReDoS) in micromatch",
        "metadata": null,
        "cves": [
          "CVE-2024-4067"
        ],
        "access": "public",
        "severity": "moderate",
        "module_name": "micromatch",
        "vulnerable_versions": "<4.0.8",
        "github_advisory_id": "GHSA-952p-6rrq-rcjv",
        "recommendation": "Upgrade to version 4.0.8 or later",
        "patched_versions": ">=4.0.8",
        "updated": "2024-08-28T13:12:27.000Z",
        "cvss": {
          "score": 5.3,
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L"
        },
        "cwe": [
          "CWE-1333"
        ],
        "url": "https://github.com/advisories/GHSA-952p-6rrq-rcjv"
      },
      "1102341": {
        "findings": [
          {
            "version": "0.21.5",
            "paths": [
              ". > @nx/next@21.4.1 > @nx/react@21.4.1 > @nx/vite@21.4.1 > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/next@21.4.1 > @nx/react@21.4.1 > @nx/vite@21.4.1 > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/next@21.4.1 > @nx/react@21.4.1 > @nx/vite@21.4.1 > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/react@21.4.1 > @nx/vite@21.4.1 > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/react@21.4.1 > @nx/vite@21.4.1 > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/react@21.4.1 > @nx/vite@21.4.1 > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/vite@21.4.1 > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/vite@21.4.1 > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @nx/vite@21.4.1 > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @vitest/coverage-v8@2.1.9 > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @vitest/coverage-v8@2.1.9 > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > @vitest/coverage-v8@2.1.9 > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              ". > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/a2a > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/a2a > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/a2a > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/a2a > esbuild@0.21.5",
              "packages/a2a/a2a-events > vitest@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/a2a/a2a-events > vitest@1.6.1 > vite-node@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/contracts > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/contracts > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/contracts > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/contracts > esbuild@0.21.5",
              "packages/cortex-ai-github > vitest@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/cortex-ai-github > vitest@1.6.1 > vite-node@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/cortex-semgrep-github > vitest@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/cortex-semgrep-github > vitest@1.6.1 > vite-node@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/cortex-structure-github > vitest@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/cortex-structure-github > vitest@1.6.1 > vite-node@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/gateway > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/gateway > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/gateway > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/mcp-registry > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/mcp-registry > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/mcp-registry > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/model-gateway > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/model-gateway > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/model-gateway > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/observability > vitest@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/observability > vitest@1.6.1 > vite-node@1.6.1 > vite@5.4.19 > esbuild@0.21.5",
              "packages/observability > esbuild@0.21.5",
              "packages/rag > vitest@2.1.9 > @vitest/mocker@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/rag > vitest@2.1.9 > vite@5.4.19 > esbuild@0.21.5",
              "packages/rag > vitest@2.1.9 > vite-node@2.1.9 > vite@5.4.19 > esbuild@0.21.5"
            ]
          },
          {
            "version": "0.18.20",
            "paths": [
              "apps/cortex-webui > vitest@0.31.4 > vite@4.5.14 > esbuild@0.18.20",
              "apps/cortex-webui > vitest@0.31.4 > vite-node@0.31.4 > vite@4.5.14 > esbuild@0.18.20",
              "apps/cortex-webui/backend > vitest@0.31.4 > vite@4.5.14 > esbuild@0.18.20",
              "apps/cortex-webui/backend > vitest@0.31.4 > vite-node@0.31.4 > vite@4.5.14 > esbuild@0.18.20",
              "apps/cortex-webui/frontend > @vitejs/plugin-react@4.7.0 > vite@4.5.14 > esbuild@0.18.20",
              "apps/cortex-webui/frontend > vite@4.5.14 > esbuild@0.18.20",
              "apps/cortex-webui/frontend > vitest@0.31.4 > vite@4.5.14 > esbuild@0.18.20",
              "apps/cortex-webui/frontend > vitest@0.31.4 > vite-node@0.31.4 > vite@4.5.14 > esbuild@0.18.20"
            ]
          }
        ],
        "found_by": null,
        "deleted": null,
        "references": "- https://github.com/evanw/esbuild/security/advisories/GHSA-67mh-4wv8-2f99\n- https://github.com/evanw/esbuild/commit/de85afd65edec9ebc44a11e245fd9e9a2e99760d\n- https://github.com/advisories/GHSA-67mh-4wv8-2f99",
        "created": "2025-02-10T17:48:07.000Z",
        "id": 1102341,
        "npm_advisory_id": null,
        "overview": "### Summary\n\nesbuild allows any websites to send any request to the development server and read the response due to default CORS settings.\n\n### Details\n\nesbuild sets `Access-Control-Allow-Origin: *` header to all requests, including the SSE connection, which allows any websites to send any request to the development server and read the response.\n\nhttps://github.com/evanw/esbuild/blob/df815ac27b84f8b34374c9182a93c94718f8a630/pkg/api/serve_other.go#L121\nhttps://github.com/evanw/esbuild/blob/df815ac27b84f8b34374c9182a93c94718f8a630/pkg/api/serve_other.go#L363\n\n**Attack scenario**:\n\n1. The attacker serves a malicious web page (`http://malicious.example.com`).\n1. The user accesses the malicious web page.\n1. The attacker sends a `fetch('http://127.0.0.1:8000/main.js')` request by JS in that malicious web page. This request is normally blocked by same-origin policy, but that's not the case for the reasons above.\n1. The attacker gets the content of `http://127.0.0.1:8000/main.js`.\n\nIn this scenario, I assumed that the attacker knows the URL of the bundle output file name. But the attacker can also get that information by\n\n- Fetching `/index.html`: normally you have a script tag here\n- Fetching `/assets`: it's common to have a `assets` directory when you have JS files and CSS files in a different directory and the directory listing feature tells the attacker the list of files\n- Connecting `/esbuild` SSE endpoint: the SSE endpoint sends the URL path of the changed files when the file is changed (`new EventSource('/esbuild').addEventListener('change', e => console.log(e.type, e.data))`)\n- Fetching URLs in the known file: once the attacker knows one file, the attacker can know the URLs imported from that file\n\nThe scenario above fetches the compiled content, but if the victim has the source map option enabled, the attacker can also get the non-compiled content by fetching the source map file.\n\n### PoC\n\n1. Download [reproduction.zip](https://github.com/user-attachments/files/18561484/reproduction.zip)\n2. Extract it and move to that directory\n1. Run `npm i`\n1. Run `npm run watch`\n1. Run `fetch('http://127.0.0.1:8000/app.js').then(r => r.text()).then(content => console.log(content))` in a different website's dev tools.\n\n![image](https://github.com/user-attachments/assets/08fc2e4d-e1ec-44ca-b0ea-78a73c3c40e9)\n\n### Impact\n\nUsers using the serve feature may get the source code stolen by malicious websites.",
        "reported_by": null,
        "title": "esbuild enables any website to send any requests to the development server and read the response",
        "metadata": null,
        "cves": [],
        "access": "public",
        "severity": "moderate",
        "module_name": "esbuild",
        "vulnerable_versions": "<=0.24.2",
        "github_advisory_id": "GHSA-67mh-4wv8-2f99",
        "recommendation": "Upgrade to version 0.25.0 or later",
        "patched_versions": ">=0.25.0",
        "updated": "2025-02-10T17:48:08.000Z",
        "cvss": {
          "score": 5.3,
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N"
        },
        "cwe": [
          "CWE-346"
        ],
        "url": "https://github.com/advisories/GHSA-67mh-4wv8-2f99"
      },
      "1103907": {
        "findings": [
          {
            "version": "0.4.2",
            "paths": [
              "packages/kernel > @cortex-os/prp-runner@link:../prp-runner > lighthouse@11.7.1 > @sentry/node@6.19.7 > cookie@0.4.2",
              "packages/prp-runner > lighthouse@11.7.1 > @sentry/node@6.19.7 > cookie@0.4.2"
            ]
          }
        ],
        "found_by": null,
        "deleted": null,
        "references": "- https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x\n- https://github.com/jshttp/cookie/pull/167\n- https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c\n- https://github.com/advisories/GHSA-pxg6-pf52-xh8x",
        "created": "2024-10-04T20:31:00.000Z",
        "id": 1103907,
        "npm_advisory_id": null,
        "overview": "### Impact\n\nThe cookie name could be used to set other fields of the cookie, resulting in an unexpected cookie value. For example, `serialize(\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a\", value)` would result in `\"userName=<script>alert('XSS3')</script>; Max-Age=2592000; a=test\"`, setting `userName` cookie to `<script>` and ignoring `value`.\n\nA similar escape can be used for `path` and `domain`, which could be abused to alter other fields of the cookie.\n\n### Patches\n\nUpgrade to 0.7.0, which updates the validation for `name`, `path`, and `domain`.\n\n### Workarounds\n\nAvoid passing untrusted or arbitrary values for these fields, ensure they are set by the application instead of user input.\n\n### References\n\n* https://github.com/jshttp/cookie/pull/167",
        "reported_by": null,
        "title": "cookie accepts cookie name, path, and domain with out of bounds characters",
        "metadata": null,
        "cves": [
          "CVE-2024-47764"
        ],
        "access": "public",
        "severity": "low",
        "module_name": "cookie",
        "vulnerable_versions": "<0.7.0",
        "github_advisory_id": "GHSA-pxg6-pf52-xh8x",
        "recommendation": "Upgrade to version 0.7.0 or later",
        "patched_versions": ">=0.7.0",
        "updated": "2025-04-15T13:56:44.000Z",
        "cvss": {
          "score": 0,
          "vectorString": null
        },
        "cwe": [
          "CWE-74"
        ],
        "url": "https://github.com/advisories/GHSA-pxg6-pf52-xh8x"
      },
      "1104664": {
        "findings": [
          {
            "version": "7.0.3",
            "paths": [
              "packages/gateway > @pact-foundation/pact@12.5.2 > @pact-foundation/pact-core@14.3.8 > cross-spawn@7.0.3"
            ]
          }
        ],
        "found_by": null,
        "deleted": null,
        "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-21538\n- https://github.com/moxystudio/node-cross-spawn/pull/160\n- https://github.com/moxystudio/node-cross-spawn/commit/5ff3a07d9add449021d806e45c4168203aa833ff\n- https://github.com/moxystudio/node-cross-spawn/commit/640d391fde65388548601d95abedccc12943374f\n- https://security.snyk.io/vuln/SNYK-JS-CROSSSPAWN-8303230\n- https://github.com/moxystudio/node-cross-spawn/issues/165\n- https://github.com/moxystudio/node-cross-spawn/commit/d35c865b877d2f9ded7c1ed87521c2fdb689c8dd\n- https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-8366349\n- https://github.com/advisories/GHSA-3xgq-45jj-v275",
        "created": "2024-11-08T06:30:47.000Z",
        "id": 1104664,
        "npm_advisory_id": null,
        "overview": "Versions of the package cross-spawn before 7.0.5 are vulnerable to Regular Expression Denial of Service (ReDoS) due to improper input sanitization. An attacker can increase the CPU usage and crash the program by crafting a very large and well crafted string.",
        "reported_by": null,
        "title": "Regular Expression Denial of Service (ReDoS) in cross-spawn",
        "metadata": null,
        "cves": [
          "CVE-2024-21538"
        ],
        "access": "public",
        "severity": "high",
        "module_name": "cross-spawn",
        "vulnerable_versions": ">=7.0.0 <7.0.5",
        "github_advisory_id": "GHSA-3xgq-45jj-v275",
        "recommendation": "Upgrade to version 7.0.5 or later",
        "patched_versions": ">=7.0.5",
        "updated": "2025-05-19T19:56:26.000Z",
        "cvss": {
          "score": 7.5,
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
        },
        "cwe": [
          "CWE-1333"
        ],
        "url": "https://github.com/advisories/GHSA-3xgq-45jj-v275"
      },
      "1106849": {
        "findings": [
          {
            "version": "0.0.33",
            "paths": [
              ". > crawlee@3.14.1 > @crawlee/cli@3.14.1 > @crawlee/templates@3.14.1 > inquirer@9.3.7 > external-editor@3.1.0 > tmp@0.0.33",
              ". > inquirer@9.3.7 > external-editor@3.1.0 > tmp@0.0.33",
              "packages/kernel > @cortex-os/prp-runner@link:../prp-runner > inquirer@9.3.7 > external-editor@3.1.0 > tmp@0.0.33",
              "packages/prp-runner > inquirer@9.3.7 > external-editor@3.1.0 > tmp@0.0.33"
            ]
          }
        ],
        "found_by": null,
        "deleted": null,
        "references": "- https://github.com/raszi/node-tmp/security/advisories/GHSA-52f5-9888-hmc6\n- https://github.com/raszi/node-tmp/commit/188b25e529496e37adaf1a1d9dccb40019a08b1b\n- https://nvd.nist.gov/vuln/detail/CVE-2025-54798\n- https://github.com/raszi/node-tmp/issues/207\n- https://github.com/advisories/GHSA-52f5-9888-hmc6",
        "created": "2025-08-06T17:06:04.000Z",
        "id": 1106849,
        "npm_advisory_id": null,
        "overview": "### Summary\n\n`tmp@0.2.3` is vulnerable to an Arbitrary temporary file / directory write via symbolic link `dir` parameter.\n\n\n### Details\n\nAccording to the documentation there are some conditions that must be held:\n\n```\n// https://github.com/raszi/node-tmp/blob/v0.2.3/README.md?plain=1#L41-L50\n\nOther breaking changes, i.e.\n\n- template must be relative to tmpdir\n- name must be relative to tmpdir\n- dir option must be relative to tmpdir //<-- this assumption can be bypassed using symlinks\n\nare still in place.\n\nIn order to override the system's tmpdir, you will have to use the newly\nintroduced tmpdir option.\n\n\n// https://github.com/raszi/node-tmp/blob/v0.2.3/README.md?plain=1#L375\n* `dir`: the optional temporary directory that must be relative to the system's default temporary directory.\n     absolute paths are fine as long as they point to a location under the system's default temporary directory.\n     Any directories along the so specified path must exist, otherwise a ENOENT error will be thrown upon access, \n     as tmp will not check the availability of the path, nor will it establish the requested path for you.\n```\n\nRelated issue: https://github.com/raszi/node-tmp/issues/207.\n\n\nThe issue occurs because `_resolvePath` does not properly handle symbolic link when resolving paths:\n```js\n// https://github.com/raszi/node-tmp/blob/v0.2.3/lib/tmp.js#L573-L579\nfunction _resolvePath(name, tmpDir) {\n  if (name.startsWith(tmpDir)) {\n    return path.resolve(name);\n  } else {\n    return path.resolve(path.join(tmpDir, name));\n  }\n}\n```\n\nIf the `dir` parameter points to a symlink that resolves to a folder outside the `tmpDir`, it's possible to bypass the `_assertIsRelative` check used in `_assertAndSanitizeOptions`:\n```js\n// https://github.com/raszi/node-tmp/blob/v0.2.3/lib/tmp.js#L590-L609\nfunction _assertIsRelative(name, option, tmpDir) {\n  if (option === 'name') {\n    // assert that name is not absolute and does not contain a path\n    if (path.isAbsolute(name))\n      throw new Error(`${option} option must not contain an absolute path, found \"${name}\".`);\n    // must not fail on valid .<name> or ..<name> or similar such constructs\n    let basename = path.basename(name);\n    if (basename === '..' || basename === '.' || basename !== name)\n      throw new Error(`${option} option must not contain a path, found \"${name}\".`);\n  }\n  else { // if (option === 'dir' || option === 'template') {\n    // assert that dir or template are relative to tmpDir\n    if (path.isAbsolute(name) && !name.startsWith(tmpDir)) {\n      throw new Error(`${option} option must be relative to \"${tmpDir}\", found \"${name}\".`);\n    }\n    let resolvedPath = _resolvePath(name, tmpDir); //<--- \n    if (!resolvedPath.startsWith(tmpDir))\n      throw new Error(`${option} option must be relative to \"${tmpDir}\", found \"${resolvedPath}\".`);\n  }\n}\n```\n\n\n### PoC\n\nThe following PoC demonstrates how writing a tmp file on a folder outside the `tmpDir` is possible.\nTested on a Linux machine.\n\n- Setup: create a symbolic link inside the `tmpDir` that points to a directory outside of it\n```bash\nmkdir $HOME/mydir1\n\nln -s $HOME/mydir1 ${TMPDIR:-/tmp}/evil-dir\n```\n\n- check the folder is empty:\n```bash\nls -lha $HOME/mydir1 | grep \"tmp-\"\n```\n\n- run the poc\n```bash\nnode main.js\nFile:  /tmp/evil-dir/tmp-26821-Vw87SLRaBIlf\ntest 1: ENOENT: no such file or directory, open '/tmp/mydir1/tmp-[random-id]'\ntest 2: dir option must be relative to \"/tmp\", found \"/foo\".\ntest 3: dir option must be relative to \"/tmp\", found \"/home/user/mydir1\".\n```\n\n- the temporary file is created under `$HOME/mydir1` (outside the `tmpDir`):\n```bash\nls -lha $HOME/mydir1 | grep \"tmp-\"\n-rw------- 1 user user    0 Apr  X XX:XX tmp-[random-id]\n```\n\n\n- `main.js`\n```js\n// npm i tmp@0.2.3\n\nconst tmp = require('tmp');\n\nconst tmpobj = tmp.fileSync({ 'dir': 'evil-dir'});\nconsole.log('File: ', tmpobj.name);\n\ntry {\n    tmp.fileSync({ 'dir': 'mydir1'});\n} catch (err) {\n    console.log('test 1:', err.message)\n}\n\ntry {\n    tmp.fileSync({ 'dir': '/foo'});\n} catch (err) {\n    console.log('test 2:', err.message)\n}\n\ntry {\n    const fs = require('node:fs');\n    const resolved = fs.realpathSync('/tmp/evil-dir');\n    tmp.fileSync({ 'dir': resolved});\n} catch (err) {\n    console.log('test 3:', err.message)\n}\n```\n\n\nA Potential fix could be to call `fs.realpathSync` (or similar) that resolves also symbolic links.\n```js\nfunction _resolvePath(name, tmpDir) {\n  let resolvedPath;\n  if (name.startsWith(tmpDir)) {\n    resolvedPath = path.resolve(name);\n  } else {\n    resolvedPath = path.resolve(path.join(tmpDir, name));\n  }\n  return fs.realpathSync(resolvedPath);\n}\n```\n\n\n### Impact\n\nArbitrary temporary file / directory write via symlink",
        "reported_by": null,
        "title": "tmp allows arbitrary temporary file / directory write via symbolic link `dir` parameter",
        "metadata": null,
        "cves": [
          "CVE-2025-54798"
        ],
        "access": "public",
        "severity": "low",
        "module_name": "tmp",
        "vulnerable_versions": "<=0.2.3",
        "github_advisory_id": "GHSA-52f5-9888-hmc6",
        "recommendation": "Upgrade to version 0.2.4 or later",
        "patched_versions": ">=0.2.4",
        "updated": "2025-08-07T15:11:23.000Z",
        "cvss": {
          "score": 2.5,
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N"
        },
        "cwe": [
          "CWE-59"
        ],
        "url": "https://github.com/advisories/GHSA-52f5-9888-hmc6"
      }
    },
    "muted": [],
    "metadata": {
      "vulnerabilities": {
        "info": 0,
        "low": 2,
        "moderate": 3,
        "high": 1,
        "critical": 0
      },
      "dependencies": 3052,
      "devDependencies": 0,
      "optionalDependencies": 0,
      "totalDependencies": 3052
    }
  },
  "cargo": {
    "database": {
      "advisory-count": 802,
      "last-commit": "20a8af2bdc91ffaa99fed197adf0e40c0e8c5edd",
      "last-updated": "2025-09-02T13:05:02+02:00"
    },
    "lockfile": {
      "dependency-count": 286
    },
    "settings": {
      "target_arch": [],
      "target_os": [],
      "severity": null,
      "ignore": [],
      "informational_warnings": [
        "unmaintained",
        "unsound",
        "notice"
      ]
    },
    "vulnerabilities": {
      "found": true,
      "count": 2,
      "list": [
        {
          "advisory": {
            "id": "RUSTSEC-2024-0421",
            "package": "idna",
            "title": "`idna` accepts Punycode labels that do not produce any non-ASCII when decoded",
            "description": "`idna` 0.5.0 and earlier accepts Punycode labels that do not produce any non-ASCII output, which means that either ASCII labels or the empty root label can be masked such that they appear unequal without IDNA processing or when processed with a different implementation and equal when processed with `idna` 0.5.0 or earlier.\n\nConcretely, `example.org` and `xn--example-.org` become equal after processing by `idna` 0.5.0 or earlier. Also, `example.org.xn--` and `example.org.` become equal after processing by `idna` 0.5.0 or earlier.\n\nIn applications using `idna` (but not in `idna` itself) this may be able to lead to privilege escalation when host name comparison is part of a privilege check and the behavior is combined with a client that resolves domains with such labels instead of treating them as errors that preclude DNS resolution / URL fetching and with the attacker managing to introduce a DNS entry (and TLS certificate) for an `xn--`-masked name that turns into the name of the target when processed by `idna` 0.5.0 or earlier.\n\n## Remedy\n\nUpgrade to `idna` 1.0.3 or later, if depending on `idna` directly, or to `url` 2.5.4 or later, if depending on `idna` via `url`. (This issue was fixed in `idna` 1.0.0, but versions earlier than 1.0.3 are not recommended for other reasons.)\n\nWhen upgrading, please take a moment to read about [alternative Unicode back ends for `idna`](https://docs.rs/crate/idna_adapter/latest).\n\nIf you are using Rust earlier than 1.81 in combination with SQLx 0.8.2 or earlier, please also read an [issue](https://github.com/servo/rust-url/issues/992) about combining them with `url` 2.5.4 and `idna` 1.0.3.\n\n## Additional information\n\nThis issue resulted from `idna` 0.5.0 and earlier implementing the UTS 46 specification literally on this point and the specification having this bug. The specification bug has been fixed in [revision 33 of UTS 46](https://www.unicode.org/reports/tr46/tr46-33.html#Modifications).\n\n## Acknowledgements\n\nThanks to kageshiron for recognizing the security implications of this behavior.",
            "date": "2024-12-09",
            "aliases": [
              "CVE-2024-12224"
            ],
            "related": [],
            "collection": "crates",
            "categories": [
              "privilege-escalation"
            ],
            "keywords": [
              "idna",
              "punycode",
              "same-origin",
              "domain-name"
            ],
            "cvss": null,
            "informational": null,
            "references": [],
            "source": null,
            "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1887898",
            "withdrawn": null,
            "license": "CC0-1.0"
          },
          "versions": {
            "patched": [
              ">=1.0.0"
            ],
            "unaffected": []
          },
          "affected": null,
          "package": {
            "name": "idna",
            "version": "0.2.3",
            "source": "registry+https://github.com/rust-lang/crates.io-index",
            "checksum": "418a0a6fab821475f634efe3ccc45c013f742efe03d853e8d3355d5cb850ecf8",
            "dependencies": [
              {
                "name": "matches",
                "version": "0.1.10",
                "source": "registry+https://github.com/rust-lang/crates.io-index"
              },
              {
                "name": "unicode-bidi",
                "version": "0.3.18",
                "source": "registry+https://github.com/rust-lang/crates.io-index"
              },
              {
                "name": "unicode-normalization",
                "version": "0.1.24",
                "source": "registry+https://github.com/rust-lang/crates.io-index"
              }
            ],
            "replace": null
          }
        },
        {
          "advisory": {
            "id": "RUSTSEC-2024-0421",
            "package": "idna",
            "title": "`idna` accepts Punycode labels that do not produce any non-ASCII when decoded",
            "description": "`idna` 0.5.0 and earlier accepts Punycode labels that do not produce any non-ASCII output, which means that either ASCII labels or the empty root label can be masked such that they appear unequal without IDNA processing or when processed with a different implementation and equal when processed with `idna` 0.5.0 or earlier.\n\nConcretely, `example.org` and `xn--example-.org` become equal after processing by `idna` 0.5.0 or earlier. Also, `example.org.xn--` and `example.org.` become equal after processing by `idna` 0.5.0 or earlier.\n\nIn applications using `idna` (but not in `idna` itself) this may be able to lead to privilege escalation when host name comparison is part of a privilege check and the behavior is combined with a client that resolves domains with such labels instead of treating them as errors that preclude DNS resolution / URL fetching and with the attacker managing to introduce a DNS entry (and TLS certificate) for an `xn--`-masked name that turns into the name of the target when processed by `idna` 0.5.0 or earlier.\n\n## Remedy\n\nUpgrade to `idna` 1.0.3 or later, if depending on `idna` directly, or to `url` 2.5.4 or later, if depending on `idna` via `url`. (This issue was fixed in `idna` 1.0.0, but versions earlier than 1.0.3 are not recommended for other reasons.)\n\nWhen upgrading, please take a moment to read about [alternative Unicode back ends for `idna`](https://docs.rs/crate/idna_adapter/latest).\n\nIf you are using Rust earlier than 1.81 in combination with SQLx 0.8.2 or earlier, please also read an [issue](https://github.com/servo/rust-url/issues/992) about combining them with `url` 2.5.4 and `idna` 1.0.3.\n\n## Additional information\n\nThis issue resulted from `idna` 0.5.0 and earlier implementing the UTS 46 specification literally on this point and the specification having this bug. The specification bug has been fixed in [revision 33 of UTS 46](https://www.unicode.org/reports/tr46/tr46-33.html#Modifications).\n\n## Acknowledgements\n\nThanks to kageshiron for recognizing the security implications of this behavior.",
            "date": "2024-12-09",
            "aliases": [
              "CVE-2024-12224"
            ],
            "related": [],
            "collection": "crates",
            "categories": [
              "privilege-escalation"
            ],
            "keywords": [
              "idna",
              "punycode",
              "same-origin",
              "domain-name"
            ],
            "cvss": null,
            "informational": null,
            "references": [],
            "source": null,
            "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1887898",
            "withdrawn": null,
            "license": "CC0-1.0"
          },
          "versions": {
            "patched": [
              ">=1.0.0"
            ],
            "unaffected": []
          },
          "affected": null,
          "package": {
            "name": "idna",
            "version": "0.3.0",
            "source": "registry+https://github.com/rust-lang/crates.io-index",
            "checksum": "e14ddfc70884202db2244c223200c204c2bda1bc6e0998d11b5e024d657209e6",
            "dependencies": [
              {
                "name": "unicode-bidi",
                "version": "0.3.18",
                "source": "registry+https://github.com/rust-lang/crates.io-index"
              },
              {
                "name": "unicode-normalization",
                "version": "0.1.24",
                "source": "registry+https://github.com/rust-lang/crates.io-index"
              }
            ],
            "replace": null
          }
        }
      ]
    },
    "warnings": {
      "unmaintained": [
        {
          "kind": "unmaintained",
          "package": {
            "name": "paste",
            "version": "1.0.15",
            "source": "registry+https://github.com/rust-lang/crates.io-index",
            "checksum": "57c0d7b74b563b49d38dae00a0c37d4d6de9b432382b2892f0574ddcae73fd0a",
            "replace": null
          },
          "advisory": {
            "id": "RUSTSEC-2024-0436",
            "package": "paste",
            "title": "paste - no longer maintained",
            "description": "The creator of the crate `paste` has stated in the [`README.md`](https://github.com/dtolnay/paste/blob/master/README.md) \nthat this project is not longer maintained as well as archived the repository\n\n## Possible Alternative(s)\n\n- [pastey](https://crates.io/crates/pastey), a fork of paste and is aimed to be a drop-in replacement with additional features for paste crate",
            "date": "2024-10-07",
            "aliases": [],
            "related": [],
            "collection": "crates",
            "categories": [],
            "keywords": [],
            "cvss": null,
            "informational": "unmaintained",
            "references": [],
            "source": null,
            "url": "https://github.com/dtolnay/paste",
            "withdrawn": null,
            "license": "CC0-1.0"
          },
          "affected": null,
          "versions": {
            "patched": [],
            "unaffected": []
          }
        }
      ]
    }
  }
}
