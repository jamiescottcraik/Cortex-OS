version: 1.0.0
metadata:
  name: AI/ML Security Patterns
  description: OWASP LLM Top 10 security patterns for AI applications
  author: Cortex OS
  updated: "2025-08-03"
rules:
  - id: PROMPT_INJECTION
    name: Prompt Injection Risk
    description: Potential prompt injection vulnerability
    severity: critical
    category: ai-security
    patterns:
      - ignore\s+previous\s+instructions
      - you\s+are\s+now\s+a\s+different
      - forget\s+everything\s+above
      - system\s*:\s*['"].*admin
    fileTypes:
      - md
      - txt
      - py
      - ts
      - js
    suggestion: Implement input validation and prompt injection detection
    owasp:
      - LLM01
  - id: MODEL_DOS
    name: Model DoS Risk
    description: Potential model denial of service vulnerability
    severity: high
    category: ai-security
    patterns:
      - max_tokens\s*=\s*\d{4,}
      - max_length\s*=\s*\d{4,}
      - temperature\s*=\s*[2-9]\.
      - while\s+True.*generate
    fileTypes:
      - py
      - ts
      - js
    suggestion: Implement rate limiting and resource constraints
    owasp:
      - LLM04
  - id: SENSITIVE_INFORMATION_DISCLOSURE
    name: Data Leakage Risk
    description: Potential sensitive information disclosure
    severity: high
    category: ai-security
    patterns:
      - (ssn|social.security).*\d{3}-?\d{2}-?\d{4}
      - (credit.card|visa|mastercard).*\d{4}.*\d{4}.*\d{4}
      - (email|e-mail).*[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}
    fileTypes:
      - py
      - ts
      - js
      - md
      - txt
    suggestion: Implement data sanitization and PII detection
    owasp:
      - LLM06
