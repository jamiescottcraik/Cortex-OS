{
  "$id": "https://cortex-os.org/tool/memory.search",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Search Memory",
  "description": "Search memories using semantic, keyword, or hybrid search",
  "type": "object",
  "required": ["query"],
  "properties": {
    "query": {
      "type": "string",
      "minLength": 1,
      "maxLength": 1000,
      "description": "Search query text"
    },
    "search_type": {
      "type": "string",
      "enum": ["semantic", "tags", "hybrid", "keyword"],
      "default": "semantic",
      "description": "Type of search to perform"
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 50
      },
      "maxItems": 10,
      "description": "Filter by tags (AND logic)"
    },
    "domain": {
      "type": "string",
      "description": "Filter by domain"
    },
    "tenant": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "Tenant namespace filter"
    },
    "labels": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 50
      },
      "maxItems": 16,
      "description": "Filter by provenance labels (AND logic)"
    },
    "limit": {
      "type": "integer",
      "minimum": 1,
      "maximum": 100,
      "default": 10,
      "description": "Maximum number of results to return"
    },
    "offset": {
      "type": "integer",
      "minimum": 0,
      "default": 0,
      "description": "Number of results to skip"
    },
    "session_filter_mode": {
      "type": "string",
      "enum": ["all", "session"],
      "default": "all",
      "description": "Filter mode for session-based memories"
    },
    "score_threshold": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "default": 0.5,
      "description": "Minimum similarity score threshold for semantic search"
    },
    "hybrid_weight": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "default": 0.6,
      "description": "Weight for semantic vs keyword search (0=keyword only, 1=semantic only)"
    }
  },
  "additionalProperties": false,
  "allOf": [
    {
      "anyOf": [
        { "required": ["domain"] },
        { "required": ["tags"] },
        { "required": ["tenant"] },
        { "required": ["labels"] }
      ]
    }
  ]
}